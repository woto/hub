<div class="row row-deck">
  <div class="col-sm-10 col-md-9 col-lg-8">
    <div class="card">
      <div class="card-status-left bg-green"></div>
      <div class="card-body">
        <%= simple_form_for @columns_form,
                            as: :columns_form,
                            method: :post,
                            url: table_columns_path(model: params[:controller], **request.params.slice(*GlobalHelper.workspace_params)),
                            local: true do |f| %>
          <%
            collection = (@settings[:form_class].parsed_columns_for(request, current_user && current_user.role) |
                @settings[:form_class].all_columns.reject { _1[:roles].exclude?(current_user && current_user.role) }.map { _1[:key] } ).map do |k|
              [t(k, scope: [:table, :long, @settings[:singular]]), k]
            end
          %>
          <%= f.input :displayed_columns,
                      input_html: {
                          multiple: true,
                          class: 'mb-1',
                          data: {
                              controller: 'table-select-columns',
                          }},
                      as: :select,
                      collection: collection,
                      hint: t('.columns_hint')
          %>

          <%= f.button :submit, t('buttons.update_displayed_columns'), class: 'btn btn-primary mt-2' %>

        <% end %>
      </div>
    </div>
  </div>
</div>
